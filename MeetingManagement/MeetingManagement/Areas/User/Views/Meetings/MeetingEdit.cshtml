@model MeetingManagement.Models.MEETING
@{
    ViewBag.Title = "Chi tiết cuộc hop";
    var Date = DateTime.Now.ToShortDateString();
}
<style>
    .edit_fixed {
        padding-left: 5px;
        width: 100%;
        max-width: none;
        border: 0px;
        height: 30px;
    }

    .switch {
        position: relative;
        display: inline-block;
        width: 60px;
        height: 34px;
    }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

    .slider {
        position: absolute;
        cursor: pointer;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: #ccc;
        -webkit-transition: .4s;
        transition: .4s;
    }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

    input:checked + .slider {
        background-color: #2196F3;
    }

    input:focus + .slider {
        box-shadow: 0 0 1px #2196F3;
    }

    input:checked + .slider:before {
        -webkit-transform: translateX(26px);
        -ms-transform: translateX(26px);
        transform: translateX(26px);
    }

    /* Rounded sliders */
    .slider.round {
        border-radius: 34px;
    }

        .slider.round:before {
            border-radius: 50%;
        }
</style>
<div>
    <ul class="progressbar" style="border: 2px solid #e5e5e5; padding: 10px; ">
        @if (Model.Status == 1)
        {
            <li class="active">Tạo cuộc họp</li>
            <li>Duyệt</li>
            <li>Đã họp</li>
            <li>Biên bản họp</li>
            <li>Hoàn thành</li>
        }
        else if (Model.Status == 2)
        {
            <li class="complete">Tạo cuộc họp</li>
            <li class="active">Duyệt</li>
            <li>
                <div onclick="alert(@Date)" style="cursor: pointer; height: 60px; width: fit-content; position: relative; display: flex; bottom: 40px; align-items: flex-end; margin: 0 auto;">
                    Đã họp
                </div>
            </li>
            <li>Biên bản họp</li>
            <li>Hoàn thành</li>
        }
        else if (Model.Status == 3)
        {
            <li class="complete">Tạo cuộc họp</li>
            <li class="complete">Duyệt</li>
            <li class="active">Đã họp</li>
            <li>Biên bản họp</li>
            <li>Hoàn thành</li>
        }
        else if (Model.Status == 4)
        {
            <li class="complete">Tạo cuộc họp</li>
            <li class="complete">Duyệt</li>
            <li class="complete">Đã họp</li>
            <li class="active">Biên bản họp</li>
            <li>Hoàn thành</li>
        }
        else if (Model.Status == 5)
        {
            <li class="complete">Tạo cuộc họp</li>
            <li class="complete">Duyệt</li>
            <li class="complete">Đã họp</li>
            <li class="complete">Biên bản họp</li>
            <li class="active">Hoàn thành</li>
        }
        else if (Model.Status == 7)
        {
            <li class="warning">
                <div onclick="alert(@Model.Feedback)" style="cursor: pointer; height: 60px; width: fit-content; position: relative; display: flex; bottom: 40px; align-items: flex-end; margin: 0 auto; }">
                    Đã hủy
                </div>
            </li>
        }
        else if (Model.Status == 6)
        {
            <li class="warning">Không được duyệt</li>
        }
    </ul>
</div>
<div style="border: 2px solid #e5e5e5; padding: 20px; width: 1000px; overflow: overlay;">
    <div class="form-row-fixed">
        @*<img src="~/Content/Picture/outline_file_upload_black_24dp.png" />*@
        @*<label class="icon-zone" for="input-ficons-1"><i class="fa fa-plus"></i></label>*@
        @if (Model.ATTACHMENTs.Count != 0)
        {
            foreach (var item in Model.ATTACHMENTs)
            {
                <a id="myfile" href="@item.Attachment_path" style="margin-right:20px;" download>
                    <div style="width:200px; height:50px; cursor:pointer; background-color:white; outline:1px solid #e5e5e5; display:inline-flex">
                        <div style="width: 25%; height: 100%; display: flex; justify-content: center; align-items: center;">
                            @if (@item.Attachment_type == "xls" || item.Attachment_type == "xlsm" || item.Attachment_type == "xlsx")
                            {
                                <i style="font-size: 40px; color: #1d6f42;" class="fas fa-file-excel text-primary"></i>
                            }
                            else if (@item.Attachment_type == "pdf")
                            {
                                <i style="font-size: 40px; color: #f40f02;" class="fas fa-file-pdf text-primary"></i>
                            }
                            else if (@item.Attachment_type == "doc" || item.Attachment_type == "docm" || item.Attachment_type == "docx")
                            {
                                <i style="font-size:40px" class="fas fa-file-word text-primary"></i>
                            }
                            else if (@item.Attachment_type == "jpg" || item.Attachment_type == "jpeg")
                            {
                                <i style="font-size: 40px; color: #34a4eb; " class="fas fa-file-image text-primary"></i>
                            }
                            else if (@item.Attachment_type == "ppt" || item.Attachment_type == "pptm" || item.Attachment_type == "pptx")
                            {
                                <i style="font-size: 40px; color: #D04423" class="fas fa-file-powerpoint text-primary"></i>
                            }
                            else
                            {
                                <i style="font-size:40px; color:gray" class="fas fa-file text-primary"></i>
                            }
                        </div>
                        <div style="width:75%; padding:0 5px; color:black">
                            <p style="text-overflow: ellipsis; overflow: hidden; width: 140px; height: 20px; white-space: nowrap; ">
                                @item.Attachment_name
                            </p>
                            <p style="font-size:10px">
                                @item.Attachment_binary
                            </p>
                        </div>
                    </div>
                </a>
                <div style="position:relative;cursor:pointer; font-size:20px; right:32px" onclick="ShowDeletePopUp(@item.Attachment_id)">x</div>
            }
        }

        @*<div id="delete-confirm-modal" class="modal">
                <span onclick="document.getElementById('id01').style.display='none'" class="close" title="Close Modal">×</span>
                <form class="modal-content" style="display: inline;">
                    <div class="container" style=" background-color: white; width: 500px; height: 200px; position: relative; top: 60px; border: 1px solid; text-align:center; }">
                        <h1>Xóa file</h1>
                        <p>Bạn sẽ không thể khôi phục lại file sau khi bấm xóa</p>
                        <div>
                            <a style="width:50px; height:30px;" onclick="document.getElementById('delete-confirm-modal').style.display='none'" class="cancelbtn">Hủy</a>
                            <a style="width: 50px; height: 30px; background-color: #f44336; color: white" type="button" onclick="document.getElementById('delete-confirm-modal').style.display='none'" class="deletebtn">Xóa</a>
                        </div>
                    </div>
                </form>
            </div>*@
        @*<div id="delete-confirm-modal" class="modal" role="dialog">
                <div class="modal-dialog" style="width:500px;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h4 class="modal-title">Xóa tài liệu</h4>
                        </div>
                        <div class="modal-body">
                            <form action="Delete">
                                Sau khi xóa sẽ không thể khôi phục lại tài liệu này?
                            </form>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn--delete">Xóa</button>
                            <button class="btn btn-normal" data-dismiss="modal">Hủy</button>
                        </div>
                    </div>
                    <div style="text-align:center;display:none" id="loader-div">
                        <img src="~/imgs/Walk.gif" style="height:100px;width:100px" />
                    </div>
                </div>
            </div>*@
    </div>
</div>
<input style=" position: relative; left: 620px; height: auto;" type="file" name="ReportFile" id="ReportFile" class="form-control" accept=".zip,.pdf,.doc,.docx,.xml,application/msword" />
<script type="text/javascript">
    $(() => {
        $('#ReportFile').on("change", function () {
            var fileUpload = document.getElementById("ReportFile");
            $('#ReportName').val(fileUpload.files[0].name);
        });
    });
</script>
@*<div style="width: 1000px; height: 34px; margin: 0px; display: flex; ">
        <div class="input-group">
            <span class="input-group-btn">
                <span class="form-group btn btn-default btn-file">
                    Browse…
                    <input type="file" name="ReportFile" id="ReportFile" class="form-control" accept=".zip,.pdf,.doc,.docx,.xml,application/msword" />
                </span>
            </span>
            <input type="text" id="ReportName" class="form-control" readonly>
        </div>
        @Html.ValidationMessage("FileAttach", "", new { @class = "text-danger custom-danger" })
        <div >
            <input type="submit" class="btn btn-danger" value="Upload" />
        </div>
    </div>*@

<div class="value-fixed" style="height:10px;">
    <div class="space"></div>
</div>
@using (Html.BeginForm("MeetingEdit", "Meetings", FormMethod.Post, new { id = "__AjaxAntiForgeryForm" }))
{
    @Html.HiddenFor(model => model.Category_id)
    @Html.HiddenFor(model => model.Meeting_id, new { @id = "meeting_id" })
    <div style=" width: 1000px; border: 2px solid #e5e5e5; padding: 10px;">
        <div class="form-row-fixed form-row-fixed-title" style="width:100%;">
            <img src="~/Content/Picture/outline_title_black_24dp.png" />
            <div class="value value-fixed">
                <div class="input-group input_fixed value-fixed-title" style="width: 800px !important;">
                    @Html.TextBoxFor(m => m.Meeting_name, new { @class = "edit_fixed", @id = "meeting_name_val" })
                </div>
            </div>
        </div>
        <div class="form-row-fixed form-row-fixed-title" style="width:100%;">
            <img src="~/Content/Picture/outline_manage_accounts_black_24dp.png" />
            <div class="value value-fixed">
                <div class="input-group input_fixed value-fixed-title" style="width: 800px !important; background-color: #f1f1f1; padding-left: 5px; height: 30px; display: flex; align-items: center;">
                    @Html.DisplayFor(m => m.AspNetUser.Full_name, new { @class = "input-fixed", @id = "Create_by" })
                </div>
            </div>
        </div>
        <div class="form-row-fixed datetime-inline">
            <img src="~/Content/Picture/outline_event_black_24dp.png" />
            <div class="value value-fixed value-fixed-location">
                <div class="input-group input_fixed">
                    <div class="input-group-desc" style="display: flex; height: 100%; width: 100%;">
                        @Html.TextBoxFor(m => m.Date_Start, "{0:yyyy-MM-dd}", new { @class = "input--style-5-fixed", @type = "date", @id = "date_start_val", @style = "width: 100%; border:0px; padding-left: 5px;height: 30px;" })
                    </div>
                </div>
            </div>
        </div>
        <!--
        -->
        <div class="form-row-fixed datetime-inline">
            <img src="~/Content/Picture/outline_schedule_black_24dp.png" />
            <div class="value value-fixed value-fixed-location">
                <div class="input-group input_fixed">
                    <div class="input-group-desc" style="display: flex; height: 100%; width: 100%;">
                        @Html.TextBoxFor(model => model.Time_Start, new { @class = "input-fixed", @type = "time", @id = "time_start_val", @style = "width: 100%; border:0px; padding-left: 5px;height: 30px;" })
                    </div>
                </div>
            </div>

        </div>
        <!--
        -->
        <div class="form-row-fixed datetime-inline" style="width:100%;">
            <img src="~/Content/Picture/outline_place_black_24dp.png" />
            <div class="value value-fixed value-fixed-location">
                <div class="input-group input_fixed" style="width:800px">
                    <div class="input-group-desc" style="display: flex; height: 100%; width: 100%;">
                        @Html.TextBoxFor(model => model.Location, new { @class = "edit_fixed", @id = "location_val" })
                    </div>
                </div>
            </div>
        </div>
        <div class="form-row-fixed" style="align-items: flex-start !important; width: 100%; margin-top: 20px !important; ">
            <img src="~/Content/Picture/outline_edit_black_24dp.png" />
            <div class="value value-fixed" style="width: 966px; min-height: 200px; border: 0px;">
                <div class="input-group" style="height: 300px; width: 100%; background: white; white-space: pre-line;">
                    @*@Html.Label(Model.Meeting_content, new { @class = "area-input", @rows = "20" })*@
                    @Html.TextAreaFor(model => model.Meeting_content, new { @class = "input-fixed", @style = "width:100%; height: 100%;padding-left: 5px;", @id = "content_val" })
                </div>
            </div>
        </div>
        @Html.HiddenFor(model => model.Create_by)
        @Html.HiddenFor(model => model.Date_Create)
        @Html.HiddenFor(model => model.Status, new { id = "status_val" })
        <div style=" width: 966px; display: flex; justify-content: center;">
            <div onclick="getCancelModel(2)" style="border:0px; width: 100px; height: 40px; background-color: #009fe5; color: white; display: inline-flex; align-items: center; justify-content: center; border-radius: 5px; cursor:pointer">
                Lưu
            </div>
            <a id="cancel-btn" onclick="location.href = '@Url.Action("Index", "Meetings")'" style="width: 100px; height: 40px; background-color: #f1f1f1; color: black; display:inline-flex; align-items: center; justify-content: center; border-radius: 5px; cursor: pointer ">
                Hủy
            </a>

        </div>
    </div>
    @*<div style="width: 300px; height: 100%; background-color: wheat; position: absolute; top: -50px; right: 0px;">

        </div>*@
}
<div id="show-popup"></div>
<div id="Feedback"></div>

<div style="height: 50px"></div>
@if (Model.Check_report == true)
{
    <div style="border: 2px solid #e5e5e5; padding: 20px; width: 1000px; overflow: overlay;">
        <div class="form-row-fixed">
                    <a id="myfile" href="@Model.REPORT.Report_link" style="margin-right:20px;" download>
                        <div style="width:200px; height:50px; cursor:pointer; background-color:white; outline:1px solid #e5e5e5; display:inline-flex">
                            <div style="width: 25%; height: 100%; display: flex; justify-content: center; align-items: center;">
                                @if (Model.REPORT.Report_type == "xls" || Model.REPORT.Report_type == "xlsm" || Model.REPORT.Report_type == "xlsx")
                                {
                                    <i style="font-size: 40px; color: #1d6f42;" class="fas fa-file-excel text-primary"></i>
                                }
                                else if (Model.REPORT.Report_type == "pdf")
                                {
                                    <i style="font-size: 40px; color: #f40f02;" class="fas fa-file-pdf text-primary"></i>
                                }
                                else if (Model.REPORT.Report_type == "doc" || Model.REPORT.Report_type == "docm" || Model.REPORT.Report_type == "docx")
                                {
                                    <i style="font-size:40px" class="fas fa-file-word text-primary"></i>
                                }
                                else if (Model.REPORT.Report_type == "jpg" || Model.REPORT.Report_type == "jpeg")
                                {
                                    <i style="font-size: 40px; color: #34a4eb; " class="fas fa-file-image text-primary"></i>
                                }
                                else if (Model.REPORT.Report_type == "ppt" || Model.REPORT.Report_type == "pptm" || Model.REPORT.Report_type == "pptx")
                                {
                                    <i style="font-size: 40px; color: #D04423" class="fas fa-file-powerpoint text-primary"></i>
                                }
                                else
                                {
                                    <i style="font-size:40px; color:gray" class="fas fa-file text-primary"></i>
                                }
                            </div>
                            <div style="width:75%; padding:0 5px; color:black">
                                <p style="text-overflow: ellipsis; overflow: hidden; width: 140px; height: 20px; white-space: nowrap; ">
                                    @Model.REPORT.Report_name
                                </p>
                                <p style="font-size:10px">
                                    @Model.REPORT.Report_binary
                                </p>
                            </div>
                        </div>
                    </a>
        </div>
    </div>
}
else
{
    @Html.Action("MeetingReport", "Meetings")

}

@*<a class="btn btn-primary-fixed" role="button" data-toggle="collapse" href="#Member" aria-expanded="false" aria-controls="Member">
        Danh sách thành viên
    </a>*@

@*<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
        Button with data-target
    </button>*@
@*<div class="collapse" id="Member" style="width:1000px;">
        <table class="table">
            <thead >
                <tr style="background-color:#f1f1f1; color:black;">
                    <th scope="col">#</th>
                    <th class="col-align" scope="col">Tên thành viên</th>
                    <th class="col-align" scope="col">Email</th>
                </tr>
            </thead>
            <tbody>
                @foreach(var member in Model.MEMBERs)
                {
                    <tr>
                        <td>@(++i)</td>
                        <td class="col-align">@member.AspNetUser.Full_name</td>
                        <td class="col-align">@member.AspNetUser.Email</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>*@
<!--<a class="btn btn-primary-fixed" role="button" data-toggle="collapse" href="#Member2" aria-expanded="false" aria-controls="Member">
    Ngoài nhà trường
</a>
<div class="collapse" id="Member2" style="width:1000px;">
    <table class="table">
        <thead>
            <tr style="background-color:#f1f1f1; color:black;">
                <th scope="col">#</th>
                <th class="col-align" scope="col">Tên thành viên</th>
                <th class="col-align" scope="col">Email</th>
            </tr>
        </thead>
        <tbody>-->
@* @for (int i = 1; i <= 10; i++)
    {
        <tr>
            <td>@i</td>
            <td class="col-align">Trần Đức Bo</td>
            <td class="col-align">bo.187pm66666</td>
        </tr>
    }*@
<!--</tbody>
    </table>
</div>-->
<style>
    .btn_catalog {
        min-width: 142px;
        height: 36px;
        border-radius: 5px;
        border: none;
        cursor: pointer;
    }

    .btn--delete {
        background: #e74c3c;
        font-family: Mulish;
        font-style: normal;
        font-weight: 600;
        font-size: 14px;
        line-height: 18px;
        text-align: center;
        color: #FFFFFF;
        margin-right: 8px;
    }



    .btn-primary-fixed {
        color: #fff;
        background-color: #009fe5;
        /* border-color: #2e6da4; */
        position: relative;
        left: 0px;
        width: 1000px;
        border-radius: 4px 4px 0px 0px;
    }

    .space {
        width: 966px;
    }

    .file-zone {
        margin-left: 34px;
        width: 300px;
        height: 50px;
    }

    .area-input {
        height: fit-content;
        min-height: 250px;
        padding: 5px;
    }

    #cancel-btn:hover {
        text-decoration: none;
    }
</style>


<script>
        function getCancelModel(type) {
            var meeting_id = $("#Meeting_id").val();
            var model_type = type;
            //var meeting_location = document.getElementById("location_val").value;
            //var meeting_content = document.getElementById("content_val").value;
        $.ajax({
            url: '@Url.Action("CancelModel", "Meetings")',
            method: 'GET',
            data: { meeting_id, model_type},
            success: function (data) {
            $("#Feedback").html(data);
            $("#modalFeedback").appendTo("body").modal("show");
            },
        error: function (err) {
            console.log(err);
        }
    })
    }
        function ShowDeletePopUp(id) {
        $.ajax({
            type: "GET",
            url: '@Url.Action("DeleteAttachment", "Meetings")',
            data: { id },
            dataType: "html",
            success: function (data) {
                $("#show-popup").html(data);
                $("#myDeleteModal").appendTo("body").modal("show");
            },
            error: function (data) {
                return false;
            }
        });
    };
</script>
@*<script type="text/javascript">
    function Edit() {
        var meeting_id = $("#Meeting_id").val();
        var meeting_name = $("#meeting_name").val();
        var date_start = $("#date_start").val();
        var time_start = $("#Time_Start").val();
        var location = $("#Location").val();
        var meet_content = $("#hrere_content").val();
        alert(meet_content);
        $.ajax({
            url: '@Url.Action("MeetingEdit", "Meetings")',
            method: 'POST',
            data: (meeting_id, meeting_name, meet_content, date_start , time_start, location),
            success: function (data) {
            window.location.href = '@Url.Action("MeetingDetail", "Meetings", new { id = Model.Meeting_id, modify = false }) ' },
            error: function (err) {
                console.log(err);
            }
        })
        }
    </script>*@
@*<script>
        function file_hidden(id)
        {
            var file = document.getElementsByClassName("myfile-" + id);
            var x = document.getElementsByClassName("x-" + id);
            $(file).addClass('hidden');
            $(x).addClass('hidden');
        }
    </script>
    <style>
        .hidden {
            display:none;
        }
    </style>*@
